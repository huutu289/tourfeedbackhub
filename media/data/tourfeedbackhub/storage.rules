rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Publicly readable content
    match /public/{allPaths=**} {
      allow read;
    }

    // Media for tours, writable by any authenticated user, publicly readable.
    match /tours/{tourId}/{allPaths=**} {
      allow read;
      allow write: if request.auth != null;
    }

    // Temporary uploads, only writable with a signed URL, readable by owner
    match /uploads/tmp/{feedbackId}/{allPaths=**} {
      // The client gets a signed URL to write here.
      // No read/write needed for direct client access after upload.
    }

    // Private admin content
    match /private/{allPaths=**} {
      allow read, write: if request.auth != null && request.auth.token.admin == true;
    }
  }
}
